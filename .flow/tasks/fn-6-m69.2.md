# fn-6-m69.2 Calendar context fetcher & ID remapping module

## Description
Create a new module `src/cal_ai/calendar/context.py` that fetches the owner's upcoming 14-day events from Google Calendar and formats them as compact prompt context with integer ID remapping.

**Files to create:**
- `src/cal_ai/calendar/context.py` — New module with `fetch_calendar_context()` and `CalendarContext` dataclass.

**Files to modify:**
- `src/cal_ai/calendar/__init__.py` — Export new module.

**Files to create (tests):**
- `tests/unit/calendar/test_context.py` — Tests for fetch, format, and ID remapping.

**Key functions:**
- `fetch_calendar_context(client: GoogleCalendarClient, now: datetime, window_days: int = 14) -> CalendarContext` — Calls `client.list_events()` for the 14-day window.
- `CalendarContext` dataclass with: `events_text: str` (formatted for prompt), `id_map: dict[int, str]` (integer→Google Calendar UUID), `event_count: int`.
- Format each event as: `[ID] Title | Start – End | Location` (one line per event, compact).
- Integer IDs start at 1, sequential. The `id_map` allows reverse lookup: `id_map[3] → "abc123googleeventid"`.

**Key decisions:**
- Place calendar context near END of prompt (lost-in-the-middle effect — LLMs attend better to start and end).
- 14-day window is configurable via parameter but defaults to 14.
- If fetch fails (network error), return empty context with warning — don't block the pipeline.
- Sort events chronologically in the formatted text.
## Acceptance
- [ ] `CalendarContext` dataclass with `events_text`, `id_map`, `event_count`
- [ ] `fetch_calendar_context()` fetches 14-day window via existing client
- [ ] Events formatted as compact one-line-per-event text with integer IDs
- [ ] `id_map` maps integers back to Google Calendar event UUIDs
- [ ] Graceful degradation on fetch failure (empty context, warning logged)
- [ ] Unit tests cover: normal fetch, empty calendar, fetch error, ID mapping
- [ ] ruff clean
## Done summary
TBD

## Evidence
- Commits:
- Tests:
- PRs:
